
```{r}
## --- Packages ------------------------------------ ##
library(multitaper)
library(pbapply)
library(kableExtra)
library(itsmr)
library(animation)
library(fields, quietly = TRUE, warn.conflicts = FALSE)

## --- Splot + Spalette ---------------------------- ##
load("C:/Users/skyep/Documents/Research/Skyes_Toolbox/splot.RData")

## --- Data (choose 1) ----------------------------- ##
load("PaperData/UMP_B200_reduced_S.RData")
# load("PaperData/UMP_B300_reduced_S.RData")

gt <- ct^2
zlim <- range(normy(tru$xtf), normy(asx), normy(ssx))
```

# GEST

```{r}
png(filename = paste0("ICASSP/PaperPlots/g_",my.type,"_B",B,".png"),
width = 5.5, height = 5, units = "in", res = 200, pointsize = 10)
# ---------------------------------------------------------------------------------

    # Prep
    par(mar = c(4,3.6,4,0))
    lim <- range(gt, sg, ag)

    # --- True g
    splot(t, gt , type = "l", ylim = lim, labs = 0, lwd = 2)

    # --- Azadeh's g
    sadd(t, ag, type = "l", col = skaturate$red, lwd = 2)

    # --- My g
    sadd(t, sg, type = "l", col = skaturate$blue, lwd = 2)
    
    # Other lines
    abline(v = range(tb), col = skrown$B1, lty = 2)
    abline(h = 0, col = skrown$B1, lty = 3)
    
    # Labels
    slab("Normalized Estimates of g(t)",
         bquote("Blockwidth B ="~.(B)*"; Mean result over 100 Simulations"), 
         "Time", "g(t)", yline = 2.5)
    legend("topright",
       legend = c("g(t)",
                  bquote(hat(g)[1]),
                  bquote(hat(g)[2])),
          col = c(skrown$B2, skaturate$red, skaturate$blue),
          lwd = 2, inset = 0.01, y.intersp = 1.25, cex = 0.9)

# ---------------------------------------------------------------------------------
dev.off()
```


# YEST

```{r}
png(filename = paste0("ICASSP/PaperPlots/yf_",my.type,"_B",B,".png"),
width = 5.5, height = 5, units = "in", res = 200, pointsize = 10)
# ---------------------------------------------------------------------------------

    # Prep
    par(mar = c(4,3.6,4,0))
    lim <- range(normy(tru$yf), syf, ayf)

    # --- True sy
    splot(Fs, normy(tru$yf), type = "l", ylim = lim, labs = 0, lwd = 2)

    # --- Azadeh's sy
    sadd(Fs, ayf, type = "l", col = skaturate$red, lwd = 2)

    # --- My sy
    sadd(Fs, syf, type = "l", col = skaturate$blue, lwd = 2)
    
    # Labels
    slab("Normalized Estimates of SY(f)",
         bquote("Stationary AR(2); Mean result over 100 Simulations"), 
         "Frequency", bquote("Spectrum"~S[Y]*"(f)"), yline = 2.5)
    legend("topright",
       legend = c(bquote(S[Y]*"(f)"),
                  bquote(hat(S)["Y, 1"]),
                  bquote(hat(S)["Y, 2"])),
          col = c(skrown$B2, skaturate$red, skaturate$blue),
          lwd = 2, inset = 0.01, y.intersp = 1.25, cex = 0.9)

# ---------------------------------------------------------------------------------
dev.off()
```


# Smooth Sgrams

```{r TRUE-SGRAM}
png(filename = paste0("ICASSP/PaperPlots/sx_",my.type,"_true",".png"),
width = 5.5, height = 5, units = "in", res = 200, pointsize = 10)
# ---------------------------------------------------------------------------------

    # Prep
    par(mar = c(4.4,4.4,4.4,0)) #, oma = c(2.5,0,0,0))
    zlim <- range(normy(tru$xtf), normy(asx), normy(ssx))

    # --- True sx
    image(Fs, t, t(normy(tru$xtf)), zlim = zlim,
      xlab = "", ylab = "", las = 1, col = tim.colors()); sox(); gc()
    slab("True TFS", "UMP: Modulated Stationary AR(2)", "Frequency", "Time")
    # image.plot(legend.only = TRUE, legend.lab = "Power", zlim = zlim,
    #            legend.line = -3, legend.cex = 0.9,
    #            horizontal  = TRUE, smallplot  = c(0.11,0.96,0,0.05))

# ---------------------------------------------------------------------------------
dev.off()
```

```{r}
png(filename = paste0("ICASSP/PaperPlots/sx_",my.type,"_B",B,"_smooth_mean",".png"),
width = 5.5, height = 5, units = "in", res = 200, pointsize = 10)
# ---------------------------------------------------------------------------------

    # Prep
    par(mar = c(4.4,4.4,4.4,0)) #, oma = c(2.5,0,0,0))

    # --- Azadeh's sy
    image(Fs, t, t(normy(ssx)), zlim = zlim,
    xlab = "", ylab = "", las = 1, col = tim.colors()); sox(); gc()
    slab("Smoothed 2-BC Spectrogram", "Mean over 100 Simulations", "Frequency", "Time")
    # image.plot(legend.only = TRUE, legend.lab = "Power", zlim = zlim,
    #            legend.line = -3, legend.cex = 0.9,
    #            horizontal  = TRUE, smallplot  = c(0.11,0.96,0,0.05))

# ---------------------------------------------------------------------------------
dev.off()
```

```{r}
png(filename = paste0("ICASSP/PaperPlots/sx_",my.type,"_B",B,"_smooth_sample",".png"),
width = 5.5, height = 5, units = "in", res = 200, pointsize = 10)
# ---------------------------------------------------------------------------------

    # Prep
    par(mar = c(4.4,4.4,4.4,0)) #, oma = c(2.5,0,0,0))

    # --- My sy
    image(Fs, t, (normy(cbc.smooth)), zlim = zlim,
    xlab = "", ylab = "", las = 1, col = tim.colors()); sox(); gc()
    slab("Smooth 2-BC Spectrogram", "Single Simulation", "Frequency", "Time")
    # image.plot(legend.only = TRUE, legend.lab = "Power", zlim = zlim,
    #            legend.line = -3, legend.cex = 0.9,
    #            horizontal  = TRUE, smallplot  = c(0.11,0.96,0,0.05))

# ---------------------------------------------------------------------------------
dev.off()
```

```{r}
png(filename = paste0("ICASSP/PaperPlots/sx_",my.type,"_B",B,"_raw_mean",".png"),
width = 5.5, height = 5, units = "in", res = 200, pointsize = 10)
# ---------------------------------------------------------------------------------

    # Prep
    par(mar = c(4.4,4.4,4.4,0)) #, oma = c(2.5,0,0,0))

    # --- My sy
    image(Fs, t, t(normy(cbc$mean)), zlim = zlim,
    xlab = "", ylab = "", las = 1, col = tim.colors()); sox(); gc()
    slab("Raw 2-BC Spectrogram", "Mean over 100 Simulations", "Frequency", "Time")
    # image.plot(legend.only = TRUE, legend.lab = "Power", zlim = zlim,
    #            legend.line = -3, legend.cex = 0.9,
    #            horizontal  = TRUE, smallplot  = c(0.11,0.96,0,0.05))

# ---------------------------------------------------------------------------------
dev.off()
```

```{r}
png(filename = paste0("ICASSP/PaperPlots/sx_",my.type,"_B",B,"_raw_sample",".png"),
width = 5.5, height = 5, units = "in", res = 200, pointsize = 10)
# ---------------------------------------------------------------------------------

    # Prep
    par(mar = c(4.4,4.4,4.4,0)) #, oma = c(2.5,0,0,0))

    # --- My sy
    image(Fs, t, t(normy(cbc.samp)), zlim = zlim,
    xlab = "", ylab = "", las = 1, col = tim.colors()); sox(); gc()
    slab("Raw 2-BC Spectrogram", "Single Simulation", "Frequency", "Time")
    # image.plot(legend.only = TRUE, legend.lab = "Power", zlim = zlim,
    #            legend.line = -3, legend.cex = 0.9,
    #            horizontal  = TRUE, smallplot  = c(0.11,0.96,0,0.05))

# ---------------------------------------------------------------------------------
dev.off()
```
